{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Granblue Fantasy: Relink Modding","text":"<ul> <li> <p> Extracting Files</p> <p>Learn how to Extract and Mod GBFR files!</p> <p> Getting started</p> <p> Mod manager</p> </li> <li> <p> Modding Resources</p> <p>All the resources for your needs can be found here</p> <p> Asset Paths</p> <p> Entity Prefixes</p> <p> File Extensions &amp; Tools</p> <p> Model IDs</p> </li> <li> <p> Importing/Exporting Models</p> <p>Learn how to import models, or create &amp; export new game models</p> <p> Importing to Blender</p> <p> Exporting from Blender</p> </li> <li> <p> Discord</p> <p>Join the Discord for mods, guidance &amp; more!</p> <p></p> </li> <li> <p> Support</p> <p>Support our work to allow us to make more things possible!</p> <p> Nenkai</p> <p> Ryn</p> </li> </ul>"},{"location":"getting_started/extraction_modding/","title":"Getting Started","text":"<p>Welcome to the world of GBFR Modding! This is where we will go over the basics for modding the game.</p>"},{"location":"getting_started/extraction_modding/#game-files","title":"Game Files","text":"<p>Tip</p> <p>The game folder can be found under <code>&lt;Steam Folder&gt;\\steamapps\\common\\Granblue Fantasy Relink</code>.</p> <p>You should be able to find the following files/folders:</p> <ul> <li><code>data/</code> - This is where most sound files are.</li> <li><code>data.i/X</code> - These contain the actual game contents that you will first need to extract.</li> </ul> <p>In order to do so, install .NET 8.0, download GBFRDataTools and extract it preferably next to the game executable.</p>"},{"location":"getting_started/extraction_modding/#gbfrdatatools","title":"GBFRDataTools","text":""},{"location":"getting_started/extraction_modding/#extracting-files","title":"Extracting Files","text":"<p>GBFRDataTools is a command-line program that you need to run under the command prompt (<code>cmd</code> or Windows Terminal on Windows).</p> <p>In order to extract most game files, run it as such:</p> Command<pre><code>GBFRDataTools.exe extract-all -i &lt;path to data.i&gt; \n</code></pre> <p>Replace <code>&lt;path to data.i&gt;</code> to the path to the <code>data.i</code> file.</p> <p>It will take some time to extract.</p> <p>Note</p> <p>Not all files will be extracted, but most. You can see the current progress on the GBFRDataTools page.</p> <p>This is because none of the data files holds the path names for their contents and had to be guessed. If you'd like to contribute, the file list can be found here, and a file accessor logger can be found here</p>"},{"location":"getting_started/extraction_modding/#modding","title":"Modding","text":"Method 1: Using Mod Manager <p> Refer to the Mod Manager Page.</p> Method 2: Modding Manually <p>Warning</p> <p>It is important that you create a backup of <code>data.i</code> first. If you do not have one, you can verify game files integrity on Steam.</p> <p>To add or update contents, simply add them to the <code>data</code> folder. You should preserve the same paths.</p> <p>Example</p> <p>If you want to mod <code>system/table/ability.tbl</code>, drop it to the <code>data</code> folder as such: <pre><code>.\n\u251c\u2500 data/ # Always preserve game paths\n\u2502  \u2514\u2500 system/\n\u2502     \u2514\u2500 table/\n\u2502        \u2514\u2500 ability.tbl\n\u2502\n...\n</code></pre></p> <p>Then run the following command: Command<pre><code>GBFRDataTools.exe add-external-files -i &lt;path to data.i&gt; \n</code></pre></p> <p>If you have successfully gotten your mod to work, congratulations!</p> Inner Workings <p>NOTE: This section only goes into detail as to how it all works and is completely optional.</p>"},{"location":"getting_started/extraction_modding/#new-files","title":"New Files","text":"<p>The <code>data.i</code> file is an index file. It holds all the information about the game's contents inside numbered <code>data</code> files. It is split in two types of content:</p> <ul> <li>Content inside archive files such as <code>data.0</code>, <code>data.1</code> and so on.</li> <li>Content outside archive files such as the sound files initially present inside the <code>data</code> folder.</li> </ul> <p>For some more notes:</p> <ul> <li><code>data.i</code> is a FlatBuffer file. The schema has been fully reverse-engineered.</li> <li>All file paths are hashed using XXHash64. Files are compressed using LZ4.</li> <li>The XXHash seed can be provided by the index file. It is set to 0 by default.</li> <li>All file hashes are ordered by their value for binary searching. Same for their descriptors within the index file, making it impossible to guess paths based on their order   inside data files.</li> <li>When modding, GBFRDataTools simply marks existing or new files as external files.</li> <li><code>data.2</code> is hardcoded to not be used.</li> </ul>"},{"location":"getting_started/mod_manager/","title":"Mod Manager","text":"<p>The Reloaded II mod manager combined with the Granblue Fantasy Relink Mod Manager mod is the primary way to manage mods for GBFR. It quickly handles what would normally be a multi-step process with GBFRDataTools for all managed mods.</p>"},{"location":"getting_started/mod_manager/#reloaded-ii","title":"Reloaded II","text":"<p>From the latest Reloaded II release, either download Release.zip and extract, or download Setup.exe and run.</p> <p>Read the Quick Start Guide to set up Reloaded II for Granblue Fantasy Relink and to learn how to install mods.</p>"},{"location":"getting_started/mod_manager/#granblue-fantasy-relink-mod-manager","title":"Granblue Fantasy Relink Mod Manager","text":"<p>Download the Granblue Fantasy Relink Mod Manager. Extract the mod into <code>Reloaded-II\\Mods</code>.</p>"},{"location":"getting_started/mod_manager/#using-the-relink-manager","title":"Using the Relink Manager","text":"<p>All asset mods for Relink require the following configuration in order to be handled:</p> <ul> <li>Set the Granblue Fantasy Relink Mod Manager as a dependency.</li> <li>Assets must be contained within GBFR\\data. For example, a mod for <code>model\\pl\\pl0101\\pl0101.minfo</code> must be located at <code>(Mod Directory)\\GBFR\\data\\model\\pl\\pl0101\\pl0101.minfo</code>.</li> </ul> <p>Tip</p> <p>The Granblue Fantasy Relink Mod Manager does not need to be enabled on its own! It will automatically be used if a dependent mod is enabled.</p>"},{"location":"models/exporting/","title":"Model Exporting","text":"<p>Note</p> <p>Exporting requires Blender knowledge and command line usage.</p>"},{"location":"models/exporting/#blender-plugin","title":"Blender Plugin","text":"<p>GBFRBlenderExporter is required for model exports. Download the latest release of the Exporter, not the Importer.</p> <p>In Blender:</p> <ul> <li>In Edit  Preferences  Add-ons</li> <li>Click <code>Install</code></li> <li>Select the zip file you just downloaded</li> <li>Make sure to tick <code>Granblue Fantasy Relink Mesh Exporter</code>.</li> </ul>"},{"location":"models/exporting/#flatbuffers","title":"Flatbuffers","text":"<p>Flatbuffers is required to edit .minfo files. Download the latest binary for your operating system (e.g. Windows.flatc.binary.zip) and extract it anywhere.</p> <p>Model Info - FlatBuffer is also required to edit .minfo files. Download the file and place it in the same folder as Flatbuffers.</p>"},{"location":"models/exporting/#exporting","title":"Exporting","text":"<p>Tip</p> <p>Currently, the Blender exporter can only be used with existing .minfo files.</p> <p>In Blender:</p> <ul> <li>In File  Export  Granblue Fantasy Relink .minfo</li> <li>Select the <code>.minfo</code> file of the edited model.</li> </ul> <p>This will create a new <code>.mmesh</code> file and a <code>.json</code> file. Copy the <code>.mmesh</code> file into every LOD folder (<code>model\\lod0</code>, <code>model\\lod1</code>, etc).</p>"},{"location":"models/exporting/#editing-the-minfo","title":"Editing the MInfo","text":"<p>Flatbuffers is a command-line program that you need to run under the command prompt (<code>cmd</code> or Windows Terminal on Windows).</p> <p>In the command line, run the following command:</p> Command<pre><code>flatc --json MInfo_ModelInfo.fbs -- &lt;path to minfo file&gt; --raw-binary\n</code></pre> <p>This will create a new JSON file in the Flatbuffers directory. </p> <p>Using the exported JSON as a reference, update the .minfo JSON as follows:</p> <ul> <li>For each entry in LODInfos:<ul> <li>Replace <code>MeshBuffers</code>, <code>Chunks</code>, <code>VertCount</code>, <code>PolyCountX3</code>, and <code>BufferTypes</code> with the ones in the exported JSON.</li> </ul> </li> <li>In <code>SubMeshes</code>, add any new submeshes to the submesh list by copying an existing submesh and replacing the name.</li> </ul> <p>Back in the command line, run the following command:</p> Command<pre><code>flatc --binary MInfo_ModelInfo.fbs -- &lt;path to minfo json&gt;\n</code></pre> <p>This will create a .bin file with the same name as your minfo. Change its file extension to .minfo, and copy it to your mod directory. </p>"},{"location":"models/importing/","title":"Model Importing","text":"<p>Note</p> <p>Importing requires Blender knowledge.</p>"},{"location":"models/importing/#blender-plugin","title":"Blender Plugin","text":"<p>GBFRBlenderImporter is required for model imports. Download the latest release of the Importer, not the Exporter.</p> <p>In Blender:</p> <ul> <li>In Edit  Preferences  Add-ons</li> <li>Click <code>Install</code></li> <li>Select the zip file you just downloaded</li> <li>Make sure to tick <code>Granblue Fantasy Relink Mesh Importer</code>.</li> </ul>"},{"location":"models/importing/#importing","title":"Importing","text":"<p>Tip</p> <ul> <li>Ensure that <code>.minfo</code>, <code>.mmesh</code> and <code>.skeleton</code> files are all in the same folder. You may need to copy the <code>.mmesh</code> over. Refer to Asset Paths for their location.</li> <li>Model heads/faces are split into their own files.</li> </ul> <p>In Blender:</p> <ul> <li>In File  Import  Granblue Fantasy Relink .minfo</li> <li>Select a .minfo file.</li> </ul>"},{"location":"resources/asset_paths/","title":"Asset Paths","text":""},{"location":"resources/asset_paths/#model-paths","title":"Model Paths","text":"<p>Refer to Entity Prefixes.</p> <ul> <li>Model Info/Skel: <code>model/{entity_type}/{entity_type}{id}/</code></li> <li>Model LOD/Meshes: <code>model_streaming/lod{lod_number}/</code></li> <li>Model Shadow LOD/Meshes: <code>model_streaming/shadowlod{lod_number}/</code></li> </ul>"},{"location":"resources/asset_paths/#ui-paths","title":"UI Paths","text":"<p>Tip</p> <p>Remove <code>fhd\\</code> for the 4k version.</p> <ul> <li>Startup Logo: <code>data\\ui\\fhd\\layouts\\title\\title\\noatlastextures</code></li> <li>Character Splasharts: <code>data\\ui\\fhd\\layouts\\common\\image_chara\\noatlastextures</code></li> <li>Character Chain Splasharts: <code>data\\ui\\fhd\\layouts\\common\\image_chain\\noatlastextures</code></li> <li>Dialogue Portraits: <code>data\\ui\\layouts\\common\\chara_voice\\noatlastextures</code></li> <li>ESC Menu: <code>data\\ui\\fhd\\layouts\\pause</code></li> <li>Spell Icons, UI Icons, Emotes etc.: <code>data\\ui\\fhd\\atlas</code></li> <li>Controller Buttons: <code>ui\\fhd\\atlas\\common_button_system.wtb</code></li> </ul>"},{"location":"resources/entity_prefixes/","title":"Entity Prefixes","text":"<ul> <li><code>ba</code> -- Map objects</li> <li><code>bg</code> -- Map geometry</li> <li><code>bh</code> -- Map breakable objects (?)</li> <li><code>ef</code> -- Effects</li> <li><code>em</code> -- Enemies</li> <li><code>et</code> -- ???</li> <li><code>fe</code> -- Enemy Faces/Heads (?)</li> <li><code>fn</code> -- NPC Faces/Heads</li> <li><code>fp</code> -- Player Faces/Heads</li> <li><code>it</code> -- ???</li> <li><code>np</code> -- NPC Bodies</li> <li><code>pl</code> -- Player Bodies</li> <li><code>tr</code> -- ???</li> <li><code>we</code> -- Enemy Weapons</li> <li><code>wn</code> -- NPC Weapons</li> <li><code>wp</code> -- Player Weapons</li> </ul>"},{"location":"resources/file_extensions/","title":"File Extensions","text":"Extension Name Can be viewed with Can be edited with <code>.bk2</code> Bink Video RAD Video Tools <code>.bnk</code> Wwise Bank Wwiser <code>.bxm</code> Binary XML Nier CLI Nier CLI <code>.evtb</code> Event Timeline Data - FlatBuffer <code>.gtp/gts</code> Granite Streamed Texture N/A N/A <code>.msg</code> MessagePack MsgPack2Json MsgPack2Json <code>.minfo</code> Model Info - FlatBuffer Flatbuffers <code>.mmat</code> Model Material - FlatBuffer Flatbuffers <code>.mmesh</code> Model Mesh Buffer GBFRBlenderImporter <code>.mot</code> Motion (Animations) GBFR2Blender2GBFR GBFR2Blender2GBFR <code>.pck</code> Wwise Pack QuickBMS + wwise_pck_extractor.bms <code>.tbl</code> System Database Table N/A (different per table) N/A <code>.wtb/.texture</code> Texture (UI mainly) F-SERVO F-SERVO"},{"location":"resources/model_ids/","title":"Model IDs","text":""},{"location":"resources/model_ids/#player-pl","title":"Player (pl)","text":"<pre><code>0000 -- Gran (Rebel)\n0001 -- Gran (original)\n0100 -- Djeeta (Rebel)\n0101 -- Djeeta (original)\n0200 -- Katalina\n0300 -- Rackam\n0400 -- Io\n0500 -- Eugen\n0600 -- Rosetta\n0700 -- Ferry \n0800 -- Lancelot\n0900 -- Vane\n1000 -- Percivale\n1100 -- Siegfried\n1200 -- Charlotta\n1300 -- Yodarha\n1400 -- Narmaya\n1500 -- Ghandagoza\n1600 -- Zeta\n1700 -- Vaseraga\n1800 -- Cagliostro\n1900 -- ID\n</code></pre>"},{"location":"resources/model_ids/#npc-np","title":"NPC (np)","text":"<pre><code>0400 -- Historiath\n</code></pre>"},{"location":"resources/model_ids/#enemy-em","title":"Enemy (em)","text":"<pre><code>2000 -- Gallanza\n2100 -- Maglielle\n2400 -- Lillith\n</code></pre>"},{"location":"resources/formats/minfo/","title":"Model Info - .minfo","text":"<p><code>.minfo</code> is the main file for any model. It describes how many lods a model has, the materials to use, how to read the <code>.mmesh</code> file buffer &amp; more.</p> <p>This file is a FlatBuffer file. </p> <ul> <li>Flatbuffer Schema</li> <li>010 Editor Template</li> </ul>"},{"location":"resources/formats/minfo/#header","title":"Header","text":"Field Name Type Description Magic/Date uint Should be <code>20230729</code>, explicitly checked. Might correspond to a date, 2023/07/09. LODInfos LodInfo[] Parameters for each lod. Each index corresponds to a <code>data/model_streaming/lod{number}</code> entry. ShadowLODInfos LodInfo[] Parameters for each shadow lod. Each index corresponds to a <code>data/model_streaming/shadowlod{number}</code> entry. A4 float Unknown. May be related to LOD distance. SubMeshes SubMeshInfo[] List of submeshes. Addressed by lod infos. Materials MaterialInfo[] List of materials used. BonesToWeightIndices ushort[] An array that matches bone indices to weight indices. Any bones not in this list are non-deform. DeformBoneBoundaryBox BBox Appears to be a boundary box for every deform bone. Not sure what the purpose of this is. A9 Vec4 Unknown. A10 Unk_A10 Unknown. Used very rarely in bgXXXX files A11 Unk_A11 Unknown. A12 float Unknown. A13 float Unknown. A14 float Unknown. A15 float Unknown. A16 float Unknown. A17 float Unknown. A18 float Unknown. A19 float Unknown. A20 float Unknown. A21 byte Unknown. A22 byte Unknown. A23 byte Unknown. A24 byte Unknown. A25 byte Unknown. A26 byte Unknown. A27 byte Unknown. A28 byte Unknown. A29 byte Unknown. A30 byte Unknown. A31 byte Unknown. A32 byte Unknown."},{"location":"resources/formats/minfo/#lodinfo","title":"LODInfo","text":"<p>Contains information on how to read a specific .mmesh, depending on LOD.</p> <p>Anything polygon related are in terms of polygons times the number of vertices per polygon.  As all models are made of tris, these can be thought of as polygon index times 3.</p> Field Name Type Description MeshBuffer MeshBufferLocator Location of each mesh buffer. Chunks LodChunk[] Parameters for each lod. Each index corresponds to a <code>data/model_streaming/lod{number}</code> entry. VertCount uint Total of vertices for this lod mesh. PolyCountX3 uint The number of polygons (times 3) in the entire .mmesh. BufferTypes byte Bitflags determining what mesh buffers are contained in the LOD. 1 = Mesh data (vertex then indices), 2 = Vertex Weight Indices, 8 = Vertex Weights A6 byte Unknown."},{"location":"resources/formats/minfo/#meshbufferlocator","title":"MeshBufferLocator","text":"<p>A <code>.mmesh</code> is broken into different \"buffers\".</p> Field Name Type Description Offset uint64 Offset of the buffer within <code>.mmesh</code>. BoundaryBox BBox Size of the buffer within <code>.mmesh</code>."},{"location":"resources/formats/minfo/#lodchunk","title":"LodChunk","text":"Field Name Type Description Offset uint Beginning polygon index (times 3) for the chunk. Count uint Number of polygons (times 3) in the chunk. SubMeshID byte The index of the submesh the chunk belongs to. MaterialID byte The index of the material the chunk belongs to. A5 byte Unknown. A6 byte Unknown."},{"location":"resources/formats/minfo/#submeshinfo","title":"SubMeshInfo","text":"<p>All .minfos are comprised of one or more submeshes. These submeshes can be toggled on and off separately.</p> Field Name Type Description Name string Name of the sub mesh. BoundaryBox BBox A boundary box for the submesh."},{"location":"resources/formats/minfo/#materialinfo","title":"MaterialInfo","text":"<p>Contains all material slots.</p> Field Name Type Description Hash XXHash32Custom(str) Unknown String hash. May need to be unique. Also referenced in a few master.evtb files. A2 byte Unknown, likely bitflags."},{"location":"resources/formats/minfo/#unk_a10","title":"Unk_A10","text":"Field Name Type Description A1 XXHash32Custom(str) Unknown String hash. Not always used. A2 float Unknown. A3 byte Unknown. A4 byte Unknown."},{"location":"resources/formats/minfo/#unk_a11","title":"Unk_A11","text":"Field Name Type Description A1 int Unknown. A2 Vec3 (?) Unknown. A3 Vec3 (?) Unknown."}]}